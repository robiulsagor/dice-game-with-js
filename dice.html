<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./style-dice.css">
</head>

<body>
    <div class="main">
        <div class="warning">
            <p>Please rotate your phone to get full functionality.</p>
        </div>

        <div class="after-win">
            <p class="win-text">Player <span id="winner">1</span> has been won.</p>
            <button id="play_again">Play Again</button>
        </div>
        <div class="left">
            <div class="score-left">
                <p class="score-text">Score: <span id="score_person_1">0</span></p>
            </div>

            <div class="number">
                <p id="number_person_1"></p>
            </div>

            <div class="play-container">
                <button class="active" id="play_person_1">Play</button>
            </div>
        </div>
        <div class="right">
            <div class="score-right">
                <p class="score-text">Score: <span id="score_person_2">0</span></p>
            </div>
            <div class="number">
                <p id="number_person_2"></p>
            </div>
            <div class="play-container">
                <button class="active" id="play_person_2">Play</button>
            </div>
        </div>
    </div>

    <script>
        const score_person_1 = document.querySelector("#score_person_1")
        const score_person_2 = document.querySelector("#score_person_2")

        let total_score_1 = 0
        let total_score_2 = 0

        const number_person_1 = document.querySelector("#number_person_1")
        const number_person_2 = document.querySelector("#number_person_2")

        const play_person_1 = document.querySelector("#play_person_1")
        const play_person_2 = document.querySelector("#play_person_2")

        let prev_number_1 = 0
        let prev_number_2 = 0

        // play_person_2.disabled = true

        const setScoreZero = (totalScore, prevScore, newScore) => {
            if (prevScore === 1 && newScore === 1) {
                return { totalScore: 0 }
            } else {
                return { totalScore: totalScore + newScore }
            }
        }

        const tossWhoFirst = () => {
            const toss = Math.floor(Math.random() * 2)
            if (toss === 1) {
                play_person_1.disabled = false
                play_person_2.disabled = true
            } else {
                play_person_1.disabled = true
                play_person_2.disabled = false
            }
        }

        tossWhoFirst()

        play_person_1.addEventListener("click", () => {
            const randomNum = Math.ceil(Math.random() * 6)
            number_person_1.innerHTML = randomNum

            const getS = setScoreZero(total_score_1, prev_number_1, randomNum)

            prev_number_1 = randomNum
            total_score_1 = getS.totalScore
            score_person_1.innerHTML = total_score_1

            setTimeout(() => {
                number_person_1.innerHTML = ""
            }, 1000)

            play_person_1.disabled = true
            play_person_2.disabled = false

        })

        play_person_2.addEventListener("click", () => {
            const randomNum = Math.ceil(Math.random() * 6)
            number_person_2.innerHTML = randomNum

            const getS = setScoreZero(total_score_2, prev_number_2, randomNum)

            prev_number_2 = randomNum
            total_score_2 = getS.totalScore
            score_person_2.innerHTML = total_score_2

            setTimeout(() => {
                number_person_2.innerHTML = ""
            }, 1000)
            play_person_2.disabled = true
            play_person_1.disabled = false

        })

        window.addEventListener("click", () => {
            if (total_score_1 >= 30 || total_score_2 >= 30) {
                play_person_2.classList.add("win")
                play_person_1.classList.add("win")

                play_person_2.disabled = true
                play_person_1.disabled = true

                if (total_score_1 > total_score_2) {
                    document.querySelector("#winner").innerHTML = 1
                } else {
                    document.querySelector("#winner").innerHTML = 2
                }
                document.querySelector(".after-win").classList.add("win")
            }

        })

        document.querySelector("#play_again").addEventListener("click", () => {
            total_score_1 = 0
            total_score_2 = 0

            prev_number_1 = 0
            prev_number_2 = 0

            play_person_2.classList.remove("win")
            play_person_1.classList.remove("win")

            score_person_1.innerHTML = total_score_1
            score_person_2.innerHTML = total_score_2

            document.querySelector(".after-win").classList.remove("win")

            tossWhoFirst()
        })


    </script>
</body>

</html>